{"ast":null,"code":"import axios from 'axios';\nimport MemberApi from './MemberApi';\n\n//공통 설정을 갖는 axios 인스턴스\nconst instance = axios.create({\n  baseURL: 'http://localhost:8080'\n});\n\n//요청 인터셉터 설정(header에 토큰큰)\ninstance.interceptors.request.use(config => {\n  const token = localStorage.getItem('accessToken');\n  console.log('🔐 Authorization 헤더 확인:', token);\n  //토큰이 존재하면\n  if (token != null) {\n    config.headers['authorization'] = `Bearer ${token}`;\n  }\n  return config;\n});\n\n//응답 인터셉터\ninstance.interceptors.response.use(\n//성공한 응답일 경우 그대로 넘기지만\n//에러 일 경우 asycn 함수가 호출\nresponse => response, async error => {\n  //error.config는 에러가 난 객체의 설정 정보\n  const originalRequest = error.config;\n\n  //토큰이 만료되었을 경우\n  if (error.response.status == 401 && !originalRequest._retry) {\n    //계속 401 에러가 날경우 무한 요청 에러를 방지지\n    originalRequest._retry = true;\n    try {\n      //리프레쉬 가져오기\n      const response = await MemberApi.getRefresh();\n      //새로 발급된 엑세스 토큰\n      console.log(response);\n      const newToken = response.data.accessToken;\n      localStorage.setItem('accessToken', newToken);\n      //요청 헤더에 새토큰 업데이트트\n      originalRequest.headers['authorization'] = `Bearer ${newToken}`;\n\n      //원래 실패했던 요청에 토큰를 다시 갱신 후 다시 요청청\n      return instance(originalRequest);\n    } catch (error) {\n      //리프레쉬 토큰 401 시 로그아웃 처리하고 다시 로그인 요청하도록 하게 에러 객체 전달\n      return Promise.reject(error);\n    }\n  }\n  return Promise.reject(error);\n});\nexport default instance;","map":{"version":3,"names":["axios","MemberApi","instance","create","baseURL","interceptors","request","use","config","token","localStorage","getItem","console","log","headers","response","error","originalRequest","status","_retry","getRefresh","newToken","data","accessToken","setItem","Promise","reject"],"sources":["C:/devv/pet_project/pet_front/src/api/axiosInstance.js"],"sourcesContent":["import axios from 'axios';\r\nimport MemberApi from './MemberApi';\r\n\r\n//공통 설정을 갖는 axios 인스턴스\r\nconst instance = axios.create({\r\n  baseURL: 'http://localhost:8080',\r\n});\r\n\r\n//요청 인터셉터 설정(header에 토큰큰)\r\ninstance.interceptors.request.use((config) => {\r\n  const token = localStorage.getItem('accessToken');\r\n  console.log('🔐 Authorization 헤더 확인:', token);\r\n  //토큰이 존재하면\r\n  if (token != null) {\r\n    config.headers['authorization'] = `Bearer ${token}`;\r\n  }\r\n  return config;\r\n});\r\n\r\n//응답 인터셉터\r\ninstance.interceptors.response.use(\r\n  //성공한 응답일 경우 그대로 넘기지만\r\n  //에러 일 경우 asycn 함수가 호출\r\n  (response) => response,\r\n  async (error) => {\r\n    //error.config는 에러가 난 객체의 설정 정보\r\n    const originalRequest = error.config;\r\n\r\n    //토큰이 만료되었을 경우\r\n    if (error.response.status == 401 && !originalRequest._retry) {\r\n      //계속 401 에러가 날경우 무한 요청 에러를 방지지\r\n      originalRequest._retry = true;\r\n\r\n      try {\r\n        //리프레쉬 가져오기\r\n        const response = await MemberApi.getRefresh();\r\n        //새로 발급된 엑세스 토큰\r\n        console.log(response);\r\n        const newToken = response.data.accessToken;\r\n\r\n        localStorage.setItem('accessToken', newToken);\r\n        //요청 헤더에 새토큰 업데이트트\r\n        originalRequest.headers['authorization'] = `Bearer ${newToken}`;\r\n\r\n        //원래 실패했던 요청에 토큰를 다시 갱신 후 다시 요청청\r\n        return instance(originalRequest);\r\n      } catch (error) {\r\n        //리프레쉬 토큰 401 시 로그아웃 처리하고 다시 로그인 요청하도록 하게 에러 객체 전달\r\n        return Promise.reject(error);\r\n      }\r\n    }\r\n    return Promise.reject(error);\r\n  }\r\n);\r\nexport default instance;\r\n"],"mappings":"AAAA,OAAOA,KAAK,MAAM,OAAO;AACzB,OAAOC,SAAS,MAAM,aAAa;;AAEnC;AACA,MAAMC,QAAQ,GAAGF,KAAK,CAACG,MAAM,CAAC;EAC5BC,OAAO,EAAE;AACX,CAAC,CAAC;;AAEF;AACAF,QAAQ,CAACG,YAAY,CAACC,OAAO,CAACC,GAAG,CAAEC,MAAM,IAAK;EAC5C,MAAMC,KAAK,GAAGC,YAAY,CAACC,OAAO,CAAC,aAAa,CAAC;EACjDC,OAAO,CAACC,GAAG,CAAC,yBAAyB,EAAEJ,KAAK,CAAC;EAC7C;EACA,IAAIA,KAAK,IAAI,IAAI,EAAE;IACjBD,MAAM,CAACM,OAAO,CAAC,eAAe,CAAC,GAAG,UAAUL,KAAK,EAAE;EACrD;EACA,OAAOD,MAAM;AACf,CAAC,CAAC;;AAEF;AACAN,QAAQ,CAACG,YAAY,CAACU,QAAQ,CAACR,GAAG;AAChC;AACA;AACCQ,QAAQ,IAAKA,QAAQ,EACtB,MAAOC,KAAK,IAAK;EACf;EACA,MAAMC,eAAe,GAAGD,KAAK,CAACR,MAAM;;EAEpC;EACA,IAAIQ,KAAK,CAACD,QAAQ,CAACG,MAAM,IAAI,GAAG,IAAI,CAACD,eAAe,CAACE,MAAM,EAAE;IAC3D;IACAF,eAAe,CAACE,MAAM,GAAG,IAAI;IAE7B,IAAI;MACF;MACA,MAAMJ,QAAQ,GAAG,MAAMd,SAAS,CAACmB,UAAU,CAAC,CAAC;MAC7C;MACAR,OAAO,CAACC,GAAG,CAACE,QAAQ,CAAC;MACrB,MAAMM,QAAQ,GAAGN,QAAQ,CAACO,IAAI,CAACC,WAAW;MAE1Cb,YAAY,CAACc,OAAO,CAAC,aAAa,EAAEH,QAAQ,CAAC;MAC7C;MACAJ,eAAe,CAACH,OAAO,CAAC,eAAe,CAAC,GAAG,UAAUO,QAAQ,EAAE;;MAE/D;MACA,OAAOnB,QAAQ,CAACe,eAAe,CAAC;IAClC,CAAC,CAAC,OAAOD,KAAK,EAAE;MACd;MACA,OAAOS,OAAO,CAACC,MAAM,CAACV,KAAK,CAAC;IAC9B;EACF;EACA,OAAOS,OAAO,CAACC,MAAM,CAACV,KAAK,CAAC;AAC9B,CACF,CAAC;AACD,eAAed,QAAQ","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}